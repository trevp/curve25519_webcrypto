<!DOCTYPE html>
<!-- saved from url=(0047)http://www.w3.org/respec/examples/template.html -->
<html lang="en" dir="ltr" typeof="bibo:Document " about="" property="dcterms:language" content="en" prefix="bibo: http://purl.org/ontology/bibo/ w3p: http://www.w3.org/2001/02pd/rec54#"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>This Is The Name Of Your Specification</title>
    <meta charset="utf-8">
    
    
  <style type="text/css"></style><style>/*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/

/* --- INLINES --- */
em.rfc2119 { 
    text-transform:     lowercase;
    font-variant:       small-caps;
    font-style:         normal;
    color:              #900;
}

h1 acronym, h2 acronym, h3 acronym, h4 acronym, h5 acronym, h6 acronym, a acronym,
h1 abbr, h2 abbr, h3 abbr, h4 abbr, h5 abbr, h6 abbr, a abbr {
    border: none;
}

dfn {
    font-weight:    bold;
}

a.internalDFN {
    color:  inherit;
    border-bottom:  1px solid #99c;
    text-decoration:    none;
}

a.externalDFN {
    color:  inherit;
    border-bottom:  1px dotted #ccc;
    text-decoration:    none;
}

a.bibref {
    text-decoration:    none;
}

cite .bibref {
    font-style: normal;
}

code {
    color:  #C83500;
}

/* --- TOC --- */
.toc a, .tof a {
    text-decoration:    none;
}

a .secno, a .figno {
    color:  #000;
}

ul.tof, ol.tof {
    list-style: none outside none;
}

.caption {
    margin-top: 0.5em;
    font-style:   italic;
}

/* --- TABLE --- */
table.simple {
    border-spacing: 0;
    border-collapse:    collapse;
    border-bottom:  3px solid #005a9c;
}

.simple th {
    background: #005a9c;
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
}

.simple th[scope="row"] {
    background: inherit;
    color:  inherit;
    border-top: 1px solid #ddd;
}

.simple td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
}

.simple tr:nth-child(even) {
    background: #f0f6ff;
}

/* --- DL --- */
.section dd > p:first-child {
    margin-top: 0;
}

.section dd > p:last-child {
    margin-bottom: 0;
}

.section dd {
    margin-bottom:  1em;
}

.section dl.attrs dd, .section dl.eldef dd {
    margin-bottom:  0;
}

@media print {
    .removeOnSave {
        display: none;
    }
}
</style><link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/W3C-ED"><!--[if lt IE 9]><script src='https://www.w3.org/2008/site/js/html5shiv.js'></script><![endif]--></head>
  <body class="h-entry" role="document" id="respecDocument"><div class="head" role="contentinfo" id="respecHeader">
  <p>
    
      <a href="http://www.w3.org/"><img width="72" height="48" src="./Curve25519_WebCrypto_files/w3c_home" alt="W3C"></a>
    
  </p>
  <h1 class="title p-name" id="title"
  property="dcterms:title">The ECDH-CURVE25519 Algorithm for WebCrypto</h1>
  
  <h2 property="dcterms:issued" datatype="xsd:dateTime"
  content="2014-08-10T00:00:00.000Z"
  id="w3c-editor-s-draft-10-august-2014"><abbr title="World Wide Web
  Consortium">W3C</abbr> Editor's Draft <time class="dt-published"
  datetime="2013-10-23">August 10 2014</time></h2>
  <dl>
    
      <dt>This version:</dt>
      <dd><a class="u-url" href=""></a></dd>
      <dt>Latest published version:</dt>
      <dd><a href="http://www.w3.org/TR/xxx-xxx/">http://www.w3.org/TR/xxx-xxx/</a></dd>
        
    <dt>Editor:</dt>
    <dd class="p-author h-card vcard" rel="bibo:editor"
    inlist=""><span typeof="foaf:Person"><a class="u-url url p-name
    fn" rel="foaf:homepage" property="foaf:name" content="Your Name"
    href="http://example.org/">Trevor Perrin</a>, <span class="ed_mailto"><a class="u-email email" rel="foaf:mbox" href="mailto:you@example.org">trevp@trevp.net</a></span></span>
</dd>

    
    
  </dl>
  
  
  
  
    
      <p class="copyright">
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> ©
        2013
        
        <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup>
        (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
        <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
        <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>), 
        
        All Rights Reserved.
        
        <abbr title="World Wide Web Consortium">W3C</abbr> <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
        
          <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a>
        
        rules apply.
      </p>
    
  
  <hr>
</div>
    <section id="abstract" class="introductory" property="dcterms:abstract" datatype="" typeof="bibo:Chapter" resource="#abstract" rel="bibo:Chapter"><h2 aria-level="1" role="heading" id="h2_abstract">Abstract</h2>
      <p>
        This is the abstract for your specification.
      </p>
    </section><section id="sotd" class="introductory" typeof="bibo:Chapter" resource="#sotd" rel="bibo:Chapter"><h2 aria-level="1" role="heading" id="h2_sotd">Status of This Document</h2>
  
    
      
        <p>
          <em>This section describes the status of this document at the time of its publication.
          Other documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the
          latest revision of this technical report can be found in the <a href="http://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at
          http://www.w3.org/TR/.</em>
        </p>
        
      <p>
        You need to have a custom SotD paragraph. Maybe give a succinct description of your spec's
        status.
      </p>
    
        <p>
          This document was published by the <a href="http://example.org/really-cool-wg">In Charge Of This Document Working Group</a> as an Editor's Draft.
          
          
            If you wish to make comments regarding this document, please send them to 
            <a href="mailto:spec-writers-anonymous@w3.org">spec-writers-anonymous@w3.org</a> 
            (<a href="mailto:spec-writers-anonymous-request@w3.org?subject=subscribe">subscribe</a>,
            <a href="http://lists.w3.org/Archives/Public/spec-writers-anonymous/">archives</a>).
          
          
          
          
            All comments are welcome.
          
        </p>
        
        
          <p>
            Publication as an Editor's Draft does not imply endorsement by the <abbr title="World Wide Web Consortium">W3C</abbr>
            Membership. This is a draft document and may be updated, replaced or obsoleted by other
            documents at any time. It is inappropriate to cite this document as other than work in
            progress.
          </p>
        
        
        
        <p>
          
            This document was produced by a group operating under the 
            <a id="sotd_patent" about="" rel="w3p:patentRules" href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 <abbr title="World Wide Web Consortium">W3C</abbr> Patent
            Policy</a>.
          
          
          
            
              <abbr title="World Wide Web Consortium">W3C</abbr> maintains a <a href="" rel="disclosure">public list of any patent
              disclosures</a> 
            
            made in connection with the deliverables of the group; that page also includes
            instructions for disclosing a patent. An individual who has actual knowledge of a patent
            which the individual believes contains
            <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential
            Claim(s)</a> must disclose the information in accordance with
            <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section
            6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
          
          
        </p>
        
          <p>This document is governed by the <a id="w3c_process_revision" href="http://www.w3.org/2014/Process-20140801/">1 August 2014 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
          </p>
        
        
      
    
  
</section><section id="toc"><h2 class="introductory" aria-level="1" role="heading" id="h2_toc">Table of Contents</h2><ul class="toc" role="directory" id="respecContents"><li class="tocline"><a href="http://www.w3.org/respec/examples/template.html#section-title" class="tocxref"><span class="secno">1. </span>Section Title</a></li><li class="tocline"><a href="http://www.w3.org/respec/examples/template.html#acknowledgements" class="tocxref"><span class="secno">A. </span>Acknowledgements</a></li></ul></section>
    
    
    
    <section id="section-title">
      <!--OddPage--><h2 aria-level="1" role="heading" id="h2_section-title"><span class="secno">1. </span>Section Title</h2>
      <p>
        Blah blah blah...
      </p>
    </section>

    <section>

     <div id="ecdh" class="section">
        <h3>2. ECDH-CURVE25519<span class="section-link">&nbsp;<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#ecdh"></a></span></h3>
        <div id="ecdh-description" class="section">
          <h4>2.1. Description<span class="section-link">&nbsp;<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#ecdh-description"></a></span></h4>
          <p>
            This describes using Elliptic Curve Diffie-Hellman (ECDH) for key generation and key
            agreement, as specified by <a href="http://cr.yp.to/ecdh/curve25519-20060209.pdf">Curve25519</a>.
          </p>
        </div>
        <div id="ecdh-registration" class="section">
          <h4>2.2. Registration<span class="section-link">&nbsp;<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#ecdh-registration"></a></span></h4>
          <p>
            The <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#recognized-algorithm-name">recognized algorithm name</a> for
            this algorithm is <code>"ECDH-CURVE25519"</code>.
          </p>
          <table>
            <thead>
              <tr>
                <th><a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#supported-operations">Operation</a></th>
                <th><a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#algorithm-specific-params">Parameters</a></th>
                <th><a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#algorithm-result">Result</a></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>generateKey</td>
                <td>None</a></td>
                <td><a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKeyPair">CryptoKeyPair</a></td>
              </tr>
              <tr>
                <td>deriveBits</td>
                <td><a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-EcdhKeyDeriveParams">EcdhKeyDeriveParams</a></td>
                <td>Octet string</td>
              </tr>
              <tr>
                <td>importKey</td>
                <td>None</td>
                <td><a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey">CryptoKey</a></td>
              </tr>
              <tr>
                <td>exportKey</td>
                <td>None</td>
                <td>object</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div id="ecdh-operations" class="section">
          <h4>2.4. Operations<span class="section-link">&nbsp;<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#ecdh-operations"></a></span></h4>
          <dl>
            <dt>Generate Key</dt>
            <dd>
              <ol>
                <li>
                  <p>
                    If <var>usages</var> contains a value which is not
                    one of <code>"deriveKey"</code> or <code>"deriveBits"</code>,
                    then <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-return-an-error">return an error</a> named
                    <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-InvalidAccessError"><code>InvalidAccessError</code></a>.
                  </p>
                </li>
                <li>
                  <p>
                    Generate an Elliptic Curve key pair, as defined in [<a href="http://cr.yp.to/ecdh/curve25519-20060209.pdf">Curve25519</a>].
                  </p>
                </li>
                <li>
                  <p>
                    If performing the operation results in an error,
                    then <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-return-an-error">return an error</a> named
                    <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-OperationError"><code>OperationError</code></a>.
                  </p>
                </li>
                <li>
                  <p>
                    Let <var>algorithm</var> be a new
                    <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-KeyAlgorithm">KeyAlgorithm</a>
                    object.
                  </p>
                </li>
                <li>
                  <p>
                    Set the <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-Algorithm-name">name</a> member of
                    <var>algorithm</var> to <code>"ECDH-CURVE25519"</code>.
                  </p>
                </li>
                <li>
                  <p>
                    Let <var>publicKey</var> be a new <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey">CryptoKey</a>
                    object representing the public key of the generated key pair.
                  </p>
                </li>
                <li>
                  <p>
                    Set the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-type">type</a>]] internal slot of
                    <var>publicKey</var> to <code>"public"</code>
                  </p>
                </li>
                <li>
                  <p>
                    Set the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-algorithm">algorithm</a>]] internal
                    slot of <var>publicKey</var> to <var>algorithm</var>.
                  </p>
                </li>
                <li>
                  <p>
                    Set the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-extractable">extractable</a>]] internal
                    slot of <var>publicKey</var> to true.
                  </p>
                </li>
                <li>
                  <p>
                    Set the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-usages">usages</a>]] internal slot of
                    <var>publicKey</var> to be the empty list.
                  </p>
                </li>
                <li>
                  <p>
                    Let <var>privateKey</var> be a new <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey">CryptoKey</a>
                    object representing the private key of the generated key pair.
                  </p>
                </li>
                <li>
                  <p>
                    Set the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-type">type</a>]] internal slot of
                    <var>privateKey</var> to <code>"private"</code>
                  </p>
                </li>
                <li>
                  <p>
                    Set the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-algorithm">algorithm</a>]] internal
                    slot of <var>privateKey</var> to <var>algorithm</var>.
                  </p>
                </li>
                <li>
                  <p>
                    Set the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-extractable">extractable</a>]] internal
                    slot of <var>privateKey</var> to <var>extractable</var>.
                  </p>
                </li>
                <li>
                  <p>
                    Set the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-usages">usages</a>]] internal slot of
                    <var>privateKey</var> to be the
                    <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-usage-intersection">usage intersection</a> of
                    <var>usages</var> and <code>[ "deriveKey", "deriveBits" ]</code>.
                  </p>
                </li>
                <li>
                  <p>
                    Let <var>result</var> be a new <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKeyPair">CryptoKeyPair</a>
                    dictionary.
                  </p>
                </li>
                <li>
                  <p>
                    Set the <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKeyPair-publicKey">publicKey</a> attribute
                    of <var>result</var> to be <var>publicKey</var>.
                  </p>
                </li>
                <li>
                  <p>
                    Set the <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKeyPair-privateKey">privateKey</a> attribute
                    of <var>result</var> to be <var>privateKey</var>.
                  </p>
                </li>
                <li>
                  <p>
                    Return the result of converting <var>result</var> to an ECMAScript Object, as
                    defined by [<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#WebIDL">WEBIDL</a>].
                  </p>
                </li>
              </ol>
            </dd>
            <dt>Derive Bits</dt>
            <dd>
              <ol>
                <li>
                  <p>
                    If the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-type">type</a>]] internal slot of
                    <var>key</var> is not <code>"private"</code>, then <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-return-an-error">return an error</a> named <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-InvalidAccessError"><code>InvalidAccessError</code></a>.
                  </p>
                </li>
                <li>
                  <p>
                    Let <var>publicKey</var> be the
                    <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-EcdhKeyDeriveParams-public">public</a> member of
                    <var>normalizedAlgorithm</var>.
                  </p>
                </li>
                <li>
                  <p>
                    If the <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-KeyAlgorithm-name">name</a> attribute of the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-algorithm">algorithm</a>]] internal slot of
                    <var>publicKey</var> is not <code>"ECDH-CURVE25519"</code>, then <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-return-an-error">return an error</a> named <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-InvalidAccessError"><code>InvalidAccessError</code></a>.
                  </p>
                </li>
                <li>
                  <p>
                    If the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-type">type</a>]] internal slot of
                    <var>publicKey</var> is not <code>"public"</code>, then <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-return-an-error">return an error</a> named <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-InvalidAccessError"><code>InvalidAccessError</code></a>.
                  </p>
                </li>
                <li>
                  <p>
                    Perform the Curve25519 function specified in
        <a
        href="http://cr.yp.to/ecdh/curve25519-20060209.pdf">Curve25519</a>
        with <var>key</var> as the EC private key (first argument) and the EC public
                    key represented by the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-handle">handle</a>]]
                    internal slot of <var>publicKey</var> (second argument).
                  </p>
                </li>
                <li>
                  <p>
                    If performing the operation results in an error,
                    then <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-return-an-error">return an error</a> named
                    <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-OperationError"><code>OperationError</code></a>.
                  </p>
                </li>
                <li>
                  <p>
                    Let <var>secret</var> be the 32-byte
        octet string output
        from the Curve25519 function defined in <a
        href="http://cr.yp.to/ecdh/curve25519-20060209.pdf">Curve25519</a>.
        In other words, <var>secret</var> is the unique 32-byte little-endian
        encoding of an integer >= 0 and < 2<sup>255</sup>-19.
                  </p>
                </li>
                <li>
                  <dl class="switch">
                    <dt>If <var>length</var> is null:</dt>
                    <dd>Return <var>secret</var></dd>
                    <dt>Otherwise:</dt>
                    <dd>
                      <dl class="switch">
                        <dt>
                          If 256 is less than
                          <var>length</var>:
                        </dt>
                        <dd>
                          <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-return-an-error">Return an error</a> named
                          <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-DataError"><code>DataError</code></a>.
                        </dd>
                        <dt>Otherwise:</dt>
                        <dd>Return the first <var>length</var> bits of <var>secret</var>.</dd>
                      </dl>
                    </dd>
                  </dl>
                </li>
              </ol>
            </dd>
          
            <dt>Import Key</dt>
            <dd>
              <ol>
                <li>
                  <p>Let <var>keyData</var> be the key data to be imported.</p>
                </li>
                <li>
                  <dl class="switch">
                    <dt>If <var>format</var> is <code>"jwk"</code>:</dt>
                    <dd>
                      <ol>
                        <li>
                          <p>
                            Let <var>jwk</var> be the <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-JsonWebKey">JsonWebKey</a>
                            dictionary represented by <var>keyData</var>.
                          </p>
                        </li>
                        <li>
                          <p>
                            If an error occurred while parsing,
                            then <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-return-an-error">return an error</a> named
                            <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-DataError"><code>DataError</code></a>.
                          </p>
                        </li>
                        <li>
                          <p>
                            If the <code>"kty"</code> field of <var>jwk</var> is
                            to <code>"EC"</code>,
                            then <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-return-an-error">return an error</a> named
                            <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-DataError"><code>DataError</code></a>.
                          </p>
                        </li>
                        <li>
                          <p>
                            If the <code>"use"</code> field of <var>jwk</var> is present,
                            then <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-return-an-error">return an error</a> named
                            <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-DataError"><code>DataError</code></a>.
                          </p>
                        </li>
                        <li>
                          <p>
                            If the <code>"key_ops"</code> field of <var>jwk</var> is present, and
                            is invalid according to the requirements of <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#jwk">JSON Web
                            Key</a>, or it does not contain all of the specified <var>usages</var>
                            values, then <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-return-an-error">return an error</a>
                            named <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-DataError"><code>DataError</code></a>.
                          </p>
                        </li>
                        <li>
                          <p>
                            If the <code>"ext"</code> field of <var>jwk</var> is present and
                            has the value false and <var>extractable</var> is true,
                            then <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-return-an-error">return an error</a> named
                            <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-DataError"><code>DataError</code></a>.
                          </p>
                        </li>
                        <li>
                        </li>
                        <li>
                          <dl class="switch">
                            <dt>If the <code>"d"</code> field is present:</dt>
                            <dd>
                              <ol>
                                <li>
                                  <p>
                                    If <var>jwk</var> does not meet the requirements of Section
                                    6.2.2 of <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#jwa">JSON Web Algorithms</a>, then <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-return-an-error">return an error</a> named <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-DataError"><code>DataError</code></a>.
                                  </p>
                                </li>
                                <li>
                                  <p>
                                    Let <var>key</var> be a new <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey">CryptoKey</a> object that represents the
                                    Elliptic Curve private key identified by interpreting
                                    <var>jwk</var> according to Section 6.2.2 of <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#jwa">JSON Web Algorithms</a>.
                                  </p>
                                </li>
                                <li>
                                  <p>
                                    Set the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-type">type</a>]]
                                    internal slot of <var>Key</var> to <code>"private"</code>.
                                  </p>
                                </li>
                              </ol>
                            </dd>
                            <dt>Otherwise:</dt>
                            <dd>
                              <ol>
                                <li>
                                  <p>
                                    If <var>jwk</var> does not meet the requirements of Section
                                    6.2.1 of <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#jwa">JSON Web Algorithms</a>, then <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-return-an-error">return an error</a> named <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-DataError"><code>DataError</code></a>.
                                  </p>
                                </li>
                                <li>
                                  <p>
                                    Let <var>key</var> be a new <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey">CryptoKey</a> object that represents the
                                    Elliptic Curve public key identified by interpreting
                                    <var>jwk</var> according to Section 6.2.1 of <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#jwa">JSON Web Algorithms</a>.
                                  </p>
                                </li>
                                <li>
                                  <p>
                                    Set the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-type">type</a>]]
                                    internal slot of <var>Key</var> to <code>"public"</code>.
                                  </p>
                                </li>
                              </ol>
                            </dd>
                          </dl>
                        </li>
                        <li>
                          <p>
                            Let <var>algorithm</var> be a new instance of an <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-KeyAlgorithm">KeyAlgorithm</a> object.
                          </p>
                        </li>
                        <li>
                          <p>
                            Set the <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-KeyAlgorithm-name">name</a> attribute of
                            <var>algorithm</var> to <code>"ECDH-CURVE25519"</code>.
                          </p>
                        </li>
                        <li>
                          <p>
                            Set the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-algorithm">algorithm</a>]]
                            internal slot of <var>key</var> to <var>algorithm</var>.
                          </p>
                        </li>
                      </ol>
                    </dd>
                    <dt>If <var>format</var> is <code>"raw"</code>:</dt>
                    <dd>
                      <ol>
                        <li>
                          <p>
                            If <var>usages</var> is not the empty list,
                            then <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-return-an-error">return an error</a> named
                            <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-DataError"><code>DataError</code></a>.
                          </p>
                        </li>
                        <li>
                          <p>
                            If <var>extractable</var> is false,
                            then <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-return-an-error">return an error</a> named
                            <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-InvalidAccessError"><code>InvalidAccessError</code></a>.
                          </p>
                        </li>
                        <li>
                          <p>
                            Let <var>Q</var> be the Curve25519 public key identified by interpreting
                            <var>keyData</var> according to <a
            href="Curve25519">Curve25519</a>.  In other words,
            <var>keyData</var> is the 32-byte little-endian
        encoding of an integer >= 0 and < 2<sup>255</sup>-19.  The
            high-order bit is ignored.  If the remaining 255 bits
            encode a number >= 2<sup>255</sup>-19, that number is
            reduced modulo 2<sup>255</sup>-19.    
                          </p>
                        </li>
                        <li>
                          <p>
                            Let <var>algorithm</var> be a new <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-KeyAlgorithm">KeyAlgorithm</a> object.
                          </p>
                        </li>
                        <li>
                          <p>
                            Set the <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-KeyAlgorithm-name">name</a> attribute of
                            <var>algorithm</var> to <code>"ECDH-CURVE25519"</code>.
                          </p>
                        </li>
                        <li>
                          <p>
                            Let <var>key</var> be a new <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey">CryptoKey</a>
                            object.
                          </p>
                        </li>
                        <li>
                          <p>
                            Set the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-type">type</a>]] internal slot
                            of <var>key</var> to <code>"public"</code>
                          </p>
                        </li>
                        <li>
                          <p>
                            Set the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-algorithm">algorithm</a>]]
                            internal slot of <var>key</var> to <var>algorithm</var>.
                          </p>
                        </li>
                        <li>
                          <p>
                            Set the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-usages">usages</a>]] internal
                            slot of <var>key</var> to <var>usages</var>.
                          </p>
                        </li>
                        <li>
                          <p>
                            Set the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-extractable">extractable</a>]]
                            internal slot of <var>key</var> to <var>extractable</var>.
                          </p>
                        </li>
                      </ol>
                    </dd>
                    <dt>Otherwise:</dt>
                    <dd>
                      <p>
                        <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-return-an-error">Return an error</a> named
                        <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-NotSupportedError"><code>NotSupportedError</code></a>.
                      </p>
                    </dd>
                  </dl>
                </li>
                <li>
                  <p>
                    Return <var>key</var>
                  </p>
                </li>
              </ol>
            </dd>

            <dt>Export Key</dt>
            <dd>
              <ol>
                <li>
                  <p>
                    Let <var>key</var> be the <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey">CryptoKey</a> to be
                    exported.
                  </p>
                </li>
                <li>
                  <p>
                    If the underlying cryptographic key material represented by the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-handle">handle</a>]] internal slot of <var>key</var>
                    cannot be accessed, then <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-return-an-error">return an
                    error</a> named <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-OperationError"><code>OperationError</code></a>.
                  </p>
                </li>
                <li>
                  <dl class="switch">
                    <dt>If <var>format</var> is <code>"jwk"</code>:</dt>
                    <dd>
                      <ol>
                        <li>
                          <p>
                            Let <var>jwk</var> be a new <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-JsonWebKey">JsonWebKey</a>
                            dictionary.
                          </p>
                        </li>
                        <li>
                          <p>
                            Set the <code>kty</code> attribute of <var>jwk</var> to
                            <code>"EC"</code>.
                          </p>
                        </li>
                        <li>
                          <p>
                            Set the <code>x</code> attribute of <var>jwk</var> according to the
                            definition in Section 6.2.1.2 of <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#jwa">JSON Web
                            Algorithms</a>.
                          </p>
                        </li>
                        <li>
                          <p>
                            Set the <code>y</code> attribute of <var>jwk</var> according to the
                            definition in Section 6.2.1.3 of <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#jwa">JSON Web
                            Algorithms</a>.
                          </p>
                        </li>
                        <li>
                          <dl class="switch">
                            <dt>
                              If the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-type">type</a>]] internal slot
                              of <var>key</var> is <code>"private"</code>
                            </dt>
                            <dd>
                              <p>
                                Set the <code>d</code> attribute of <var>jwk</var> according to the
                                definition in Section 6.2.2.1 of <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#jwa">JSON Web
                                Algorithms</a>.
                              </p>
                            </dd>
                          </dl>
                        </li>
                        <li>
                          <p>
                            Set the <code>key_ops</code> attribute of <var>jwk</var> to the
                            <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-usages">usages</a> attribute of <var>key</var>.
                          </p>
                        </li>
                        <li>
                          <p>
                            Set the <code>ext</code> attribute of <var>jwk</var> to the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-extractable">extractable</a>]] internal slot
                            of <var>key</var>.
                          </p>
                        </li>
                        <li>
                          <p>
                            Let <var>result</var> be the result of converting <var>jwk</var>
                            to an ECMAScript Object, as defined by [<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#WebIDL">WEBIDL</a>].
                          </p>
                        </li>
                      </ol>
                    </dd>
                    <dt>
                      If <var>format</var> is <code>"raw"</code>:
                    </dt>
                    <dd>
                      <ol>
                        <li>
                          <p>
                            If the [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-type">type</a>]] internal slot
                            of <var>key</var> is not <code>"public"</code>, then <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-return-an-error">return an error</a> named <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-InvalidAccessError"><code>InvalidAccessError</code></a>.
                          </p>
                        </li>
                        <li>
                          <p>
                            Let <var>data</var> be the 32-byte octet string
            representing the Curve25519 public key represented by [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-CryptoKey-slot-handle">handle</a>]] internal slot of
                            <var>key</var> according to <a
            href="http://cr.yp.to/ecdh/curve25519-20060209.pdf">Curve25519</a>.  In other words,
            <var>data</var> is the unique 32-byte little-endian
        encoding of an integer >= 0 and < 2<sup>255</sup>-19.
                          </p>
                        </li>
                        <li>
                          <p>
                            Let <var>result</var> be a new <code>ArrayBuffer</code> containing
                            <var>data</var>.
                          </p>
                        </li>
                      </ol>
                    </dd>
                    <dt>Otherwise:</dt>
                    <dd>
                      <p>
                        <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#concept-return-an-error">Return an error</a> named
                        <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-NotSupportedError"><code>NotSupportedError</code></a>.
                      </p>
                    </dd>
                  </dl>
                </li>
                <li>
                  <p>
                    Return <var>result</var>.
                  </p>
                </li>
              </ol>
            </dd>
          </dl>
        </div>
      </div>

   </section>
    
    <section class="appendix" id="acknowledgements">
      <!--OddPage--><h2 aria-level="1" role="heading" id="h2_acknowledgements"><span class="secno">A. </span>Acknowledgements</h2>
      <p>
        Thanks to Dan Berstein for inventing Curve25519.  Thanks to
      Ryan Sleevi for his tireless work on WebCrypto.
      </p>
    </section>
  

<div id="respec-ui" class="removeOnSave" style="position: fixed; top: 20px; right: 20px; width: 202px; text-align: right;"><button style="font-weight: bold; border: 1px solid rgb(204, 204, 204); border-top-left-radius: 5px; border-top-right-radius: 5px; border-bottom-right-radius: 5px; border-bottom-left-radius: 5px; background: rgb(255, 255, 255);">ReSpec</button><button style="color: rgb(255, 255, 255); font-weight: bold; border: none; border-top-left-radius: 5px; border-top-right-radius: 5px; border-bottom-right-radius: 5px; border-bottom-left-radius: 5px; margin-left: 5px; background: rgb(255, 102, 0);">1</button><div style="border: 1px solid rgb(0, 0, 0); width: 200px; display: none; text-align: left; margin-top: 5px; margin-right: 5px; background: rgb(255, 255, 255);"><button style="border-style: none none solid; border-bottom-width: 1px; border-bottom-color: rgb(204, 204, 204); width: 100%; text-align: left; font-size: inherit; background: rgb(255, 255, 255);">Save Snapshot</button><button style="border-style: none none solid; border-bottom-width: 1px; border-bottom-color: rgb(204, 204, 204); width: 100%; text-align: left; font-size: inherit; background: rgb(255, 255, 255);">About ReSpec</button><button style="border-style: none none solid; border-bottom-width: 1px; border-bottom-color: rgb(204, 204, 204); width: 100%; text-align: left; font-size: inherit; background: rgb(255, 255, 255);">Search Specref DB</button></div></div></body></html>